-- IF YOU FOUND BUGS DM ME IN TELEGRAM @IDKIDK1010


local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/bloodball/-back-ups-for-libs/main/wizard"))()
local PhantomForcesWindow = Library:NewWindow("Autofarm")
local idkidk1010 = PhantomForcesWindow:NewSection("Telegram @idkidk1010")

local Players = game.Players
local Player = Players.LocalPlayer
local RunService = game:GetService("RunService")

local AutofarmStarted = false
local CurrentCoinType = "Candy"
local AutofarmDelay = 1.1
local AutofarmIN = false
local safeHeight = 10

local function showNotification(message, duration)
    local screenGui = Instance.new("ScreenGui")
    local textLabel = Instance.new("TextLabel")

    screenGui.Parent = Player:WaitForChild("PlayerGui")

    textLabel.Size = UDim2.new(0.5, 0, 0.1, 0)
    textLabel.Position = UDim2.new(0.25, 0, 0.45, 0)
    textLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.TextScaled = true
    textLabel.Text = message
    textLabel.Parent = screenGui

    task.wait(duration)
    screenGui:Destroy()
end

showNotification("if u found bugs dm me telegram @idkidk1010", 7)

local function PcallTP(Position)
    if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
        Player.Character.HumanoidRootPart.CFrame = Position
    end
end

local function returnCoinContainer()
    for _, v in workspace:GetChildren() do
        if v:FindFirstChild("CoinContainer") and v:IsA("Model") then
            return v:FindFirstChild("CoinContainer")
        end
    end
    return nil
end

local function maintainHeight()
    while AutofarmStarted do
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            local rootPart = Player.Character.HumanoidRootPart
            local currentHeight = rootPart.Position.Y
            
            if currentHeight < safeHeight then
                rootPart.Position = Vector3.new(rootPart.Position.X, safeHeight, rootPart.Position.Z)
            end
        end
        task.wait(0.1)
    end
end

local function collectCandy()
    while AutofarmStarted do
        if AutofarmIN and Player.Character then
            local coinContainer = returnCoinContainer()
            if coinContainer then
                for _, v in pairs(coinContainer:GetChildren()) do
                    if v:GetAttribute("CoinID") == CurrentCoinType and v:FindFirstChild("TouchInterest") then
                        local candyPosition = v.Position.Y
                        if candyPosition > safeHeight then
                            PcallTP(v.CFrame)
                            task.wait(1.1)
                            PcallTP(CFrame.new(-106.6747, 195.9945, 69.0291))
                            break
                        end
                    end
                end
            end
        end
        task.wait(AutofarmDelay)
    end
end

idkidk1010:CreateToggle("Auto farm candy", function(value)
    AutofarmStarted = value
    AutofarmIN = true
    if AutofarmStarted then
        collectCandy()
        maintainHeight()
    else
        AutofarmIN = false
    end
end)

RoundStartEvent.OnClientEvent:Connect(function()
    if AutofarmStarted then
    end
    AutofarmIN = true
end)

RoundEndEvent.OnClientEvent:Connect(function()
    AutofarmIN = false
    AutofarmStarted = false
end)

Player.CharacterAdded:Connect(function()
    if AutofarmStarted then
        AutofarmIN = false
        AutofarmStarted = false
        Library:Notify("Auto farm turned off due to character respawn.")
    end
end)